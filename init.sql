-- MySQL Script generated by MySQL Workbench
-- Clean version with DROP TABLE IF EXISTS added
-- Thu Sep 25 15:44:46 2025

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

CREATE SCHEMA IF NOT EXISTS `mydb` DEFAULT CHARACTER SET utf8 ;
USE `mydb` ;

-- -----------------------------------------------------
-- Table project_managers
-- -----------------------------------------------------
DROP TABLE IF EXISTS `project_managers`;
CREATE TABLE `project_managers` (
  `username` VARCHAR(16) NOT NULL,
  `email` VARCHAR(255) NULL,
  `password` VARCHAR(32) NOT NULL,
  `project_code` INT NULL,
  `employee_code` INT NOT NULL,
  PRIMARY KEY (`employee_code`)
);

INSERT INTO project_managers (username, email, password, project_code, employee_code) VALUES
('alejandro.pm', 'alejandro.pm@solv.com', 'pass', 101, 1),
('bob.pm',       'bob.pm@solv.com',       'pass', 102, 2),
('caroline.pm',  'caroline.pm@solv.com',  'pass', 103, 3),
('david.pm',     'david.pm@solv.com',     'pass', 104, 4),
('eve.pm',       'eve.pm@solv.com',       'pass', 105, 5);

-- -----------------------------------------------------
-- Table developers
-- -----------------------------------------------------
DROP TABLE IF EXISTS `developers`;
CREATE TABLE `developers` (
  `username` VARCHAR(16) NOT NULL,
  `email` VARCHAR(255) NULL,
  `password` VARCHAR(32) NOT NULL,
  `project_code` INT NULL,
  `employee_code` INT NOT NULL,
  `project_managers_employee_code` INT NOT NULL,
  PRIMARY KEY (`employee_code`),
  INDEX `fk_developers_project_managers1_idx` (`project_managers_employee_code` ASC),
  CONSTRAINT `fk_developers_project_managers1`
    FOREIGN KEY (`project_managers_employee_code`)
    REFERENCES `project_managers` (`employee_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO developers (username, email, password, project_code, employee_code, project_managers_employee_code) VALUES
('john.dev',  'john.dev@solv.com',  'dev123', 101, 11, 1),
('sara.dev',  'sara.dev@solv.com',  'dev123', 102, 12, 2),
('mike.dev',  'mike.dev@solv.com',  'dev123', 103, 13, 3),
('linda.dev', 'linda.dev@solv.com', 'dev123', 104, 14, 4),
('tom.dev',   'tom.dev@solv.com',   'dev123', 105, 15, 5),
('anna.dev',  'anna.dev@solv.com',  'dev123', 101, 16, 1),
('peter.dev', 'peter.dev@solv.com', 'dev123', 102, 17, 2);

-- -----------------------------------------------------
-- Table projects_history
-- -----------------------------------------------------
DROP TABLE IF EXISTS `projects_history`;
CREATE TABLE `projects_history` (
  `project_code` INT NOT NULL,
  `name` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`project_code`)
);

INSERT INTO projects_history (project_code, name) VALUES
(101, 'Billing API'),
(102, 'E-Commerce Platform'),
(103, 'Cloud Migration'),
(104, 'AI Chatbot'),
(105, 'Data Lake Implementation');

-- -----------------------------------------------------
-- Table client_details
-- -----------------------------------------------------
DROP TABLE IF EXISTS `client_history`;
CREATE TABLE `client_history` (
  `client_details_email` VARCHAR(255) NOT NULL,
  `projects_history_project_code` INT NOT NULL,
  `username` VARCHAR(16) NOT NULL,
  `Number_of_projects` INT(10) NULL,
  CONSTRAINT `fk_client_client_details`
    FOREIGN KEY (`client_details_email`, `projects_history_project_code`)
    REFERENCES `client_details` (`email`, `projects_history_project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);


INSERT IGNORE INTO client_details (username, email, password, projects_history_project_code) VALUES
('acme',     'contact.acme@gmail.com',    'client123', 101),
('tricell',  'support.tricell@gmail.com', 'client123', 102),
('stark',    'support.stark@gmail.com',   'client123', 103),
('umbrella', 'info.umbrella@gmail.com',   'client123', 104),
('wayne',    'tech.wayne@gmail.com',      'client123', 105);

-- -----------------------------------------------------
-- Table client_history
-- -----------------------------------------------------
DROP TABLE IF EXISTS `client_history`;
CREATE TABLE `client_history` (
  `client_details_email` VARCHAR(255) NOT NULL,
  `projects_history_project_code` INT NOT NULL,
  `username` VARCHAR(16) NOT NULL,
  `Number_of_projects` INT(10) NULL,
  CONSTRAINT `fk_client_client_details`
    FOREIGN KEY (`client_details_email`, `projects_history_project_code`)
    REFERENCES `client_details` (`email`, `projects_history_project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);


INSERT IGNORE INTO client_history (client_details_email, username, Number_of_projects) VALUES
('contact.acme@gmail.com',    'acme',     3),
('support.tricell@gmail.com', 'tricell',  5),
('support.stark@gmail.com',   'stark',    2),
('info.umbrella@gmail.com',   'umbrella', 4),
('tech.wayne@gmail.com',      'wayne',    6);

-- -----------------------------------------------------
-- Table python_projects
-- -----------------------------------------------------
DROP TABLE IF EXISTS `python_projects`;
CREATE TABLE `python_projects` (
  `project_code` INT NOT NULL,
  `name` VARCHAR(255) NOT NULL,
  `client_comments` VARCHAR(45) NULL,
  `client_score (1/10)` INT(5) NULL,
  `python_version` DECIMAL(5) NULL,
  PRIMARY KEY (`project_code`),
  CONSTRAINT `fk_python_projects_java_projects1`
    FOREIGN KEY (`project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO python_projects (project_code, name, client_comments, `client_score (1/10)`, python_version) VALUES
(101, 'Billing API', 'Very stable', 9, 3.9),
(104, 'AI Chatbot',  'Good but slow', 7, 3.8);

-- -----------------------------------------------------
-- Table javascript_projects
-- -----------------------------------------------------
DROP TABLE IF EXISTS `javascript_projects`;
CREATE TABLE `javascript_projects` (
  `project_code` INT NOT NULL,
  `name` VARCHAR(255) NOT NULL,
  `client_comments` VARCHAR(45) NULL,
  `client_core (1/10)` INT(5) NULL,
  `javascript_version` DECIMAL(5) NULL,
  `Used_in_backiend` TINYINT(1) NULL,
  PRIMARY KEY (`project_code`),
  CONSTRAINT `fk_javascript_projects_java_projects1`
    FOREIGN KEY (`project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO javascript_projects (project_code, name, client_comments, `client_core (1/10)`, javascript_version, Used_in_backiend) VALUES
(102, 'E-Commerce Platform', 'User friendly', 8, 14, 1);

-- -----------------------------------------------------
-- Table java_projects
-- -----------------------------------------------------
DROP TABLE IF EXISTS `java_projects`;
CREATE TABLE `java_projects` (
  `project_code` INT NOT NULL,
  `name` VARCHAR(255) NOT NULL,
  `client_comments` VARCHAR(45) NULL,
  `client_score(1/10)` INT NULL,
  `java_version` DECIMAL(5) NULL,
  PRIMARY KEY (`project_code`),
  CONSTRAINT `fk_projects_history_java_projects1`
    FOREIGN KEY (`project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO java_projects (project_code, name, client_comments, `client_score(1/10)`, java_version) VALUES
(103, 'Cloud Migration',         'Excellent scalability', 9, 11),
(105, 'Data Lake Implementation','Complex but robust',    8, 17);

-- -----------------------------------------------------
-- Table time_invested
-- -----------------------------------------------------
DROP TABLE IF EXISTS `time_invested`;
CREATE TABLE `time_invested` (
  `start_time` TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP,
  `finish_time` TIMESTAMP NULL,
  `projects_history_project_code` INT NOT NULL,
  INDEX `fk_time_invested_projects_history1_idx` (`projects_history_project_code` ASC),
  CONSTRAINT `fk_time_invested_projects_history1`
    FOREIGN KEY (`projects_history_project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO time_invested (start_time, finish_time, projects_history_project_code) VALUES
('2025-01-01 09:00:00', '2025-01-15 18:00:00', 101),
('2025-02-01 09:00:00', '2025-02-20 18:00:00', 102),
('2025-03-01 09:00:00', '2025-03-30 18:00:00', 103),
('2025-04-01 09:00:00', '2025-04-18 18:00:00', 104),
('2025-05-01 09:00:00', '2025-05-25 18:00:00', 105);

-- -----------------------------------------------------
-- Table income_projects
-- -----------------------------------------------------
DROP TABLE IF EXISTS `income_projects`;
CREATE TABLE `income_projects` (
  `report_number` INT NOT NULL,
  `total_income (USD)` DECIMAL(16) NOT NULL,
  `comments_on_income` VARCHAR(255) NOT NULL,
  `projects_history_project_code` INT NOT NULL,
  PRIMARY KEY (`report_number`),
  CONSTRAINT fk_income_project
    FOREIGN KEY (`projects_history_project_code`)
    REFERENCES `projects_history` (`project_code`)
);


INSERT INTO income_projects (`total_income (USD)`, comments_on_income, projects_history_project_code, report_number) VALUES
(250000, 'High demand from clients',       101, 1001),
(180000, 'Steady sales',                   102, 1002),
(300000, 'Enterprise migration deal',      103, 1003),
(220000, 'AI adoption increasing',         104, 1004),
(270000, 'Large data analytics contract',  105, 1005);

-- -----------------------------------------------------
-- Table resources_invested
-- -----------------------------------------------------
DROP TABLE IF EXISTS `resources_invested`;
CREATE TABLE `resources_invested` (
  `total_spent (USD)` DECIMAL(16) NOT NULL,
  `comments_on_spendings` VARCHAR(255) NOT NULL,
  `projects_history_project_code` INT NOT NULL,
  `report_number` INT NULL,
  PRIMARY KEY (`projects_history_project_code`),
  INDEX `fk_resources_invested_projects_history1_idx` (`projects_history_project_code` ASC),
  INDEX `fk_resources_invested_income_projects1_idx` (`report_number` ASC),
  CONSTRAINT `fk_resources_invested_projects_history1`
    FOREIGN KEY (`projects_history_project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_resources_invested_income_projects1`
    FOREIGN KEY (`report_number`)
    REFERENCES `income_projects` (`report_number`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO resources_invested (`total_spent (USD)`, comments_on_spendings, projects_history_project_code, report_number) VALUES
(100000, 'Development resources',     101, 1001),
( 75000, 'Frontend/backend team',     102, 1002),
(150000, 'Cloud infra + devops',      103, 1003),
( 90000, 'AI engineers and infra',    104, 1004),
(120000, 'Data engineers + storage',  105, 1005);

-- -----------------------------------------------------
-- Table splunk_monitoring
-- -----------------------------------------------------
DROP TABLE IF EXISTS `splunk_monitoring`;
CREATE TABLE `splunk_monitoring` (
  `project_code` INT NOT NULL,
  `monitor_comments` VARCHAR(255) NOT NULL,
  `number_incidents` INT(5) NULL,
  PRIMARY KEY (`project_code`),
  CONSTRAINT `fk_javascript_projects_java_projects10`
    FOREIGN KEY (`project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO splunk_monitoring (project_code, monitor_comments, number_incidents) VALUES
(101, 'Stable logs',                     1),
(102, 'Minor errors in checkout flow',   3),
(103, 'Cloud warnings resolved quickly', 2),
(104, 'Few latency spikes',              5),
(105, 'Heavy loads but stable',          4);

-- -----------------------------------------------------
-- Table AWS_cloud
-- -----------------------------------------------------
DROP TABLE IF EXISTS `AWS_cloud`;
CREATE TABLE `AWS_cloud` (
  `project_code` INT NOT NULL,
  `number_of_regions` INT(5) NULL,
  PRIMARY KEY (`project_code`),
  CONSTRAINT `fk_javascript_projects_java_projects101`
    FOREIGN KEY (`project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO AWS_cloud (project_code, number_of_regions) VALUES
(101, 5),
(103, 7);

-- -----------------------------------------------------
-- Table Azure_cloud
-- -----------------------------------------------------
DROP TABLE IF EXISTS `Azure_cloud`;
CREATE TABLE `Azure_cloud` (
  `project_code` INT NOT NULL,
  `number_of_regions` INT(5) NULL,
  PRIMARY KEY (`project_code`),
  CONSTRAINT `fk_javascript_projects_java_projects1010`
    FOREIGN KEY (`project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO Azure_cloud (project_code, number_of_regions) VALUES
(102, 4),
(105, 6);

-- -----------------------------------------------------
-- Table GCP_cloud
-- -----------------------------------------------------
DROP TABLE IF EXISTS `GCP_cloud`;
CREATE TABLE `GCP_cloud` (
  `project_code` INT NOT NULL,
  `number_of_regions` INT(5) NULL,
  PRIMARY KEY (`project_code`),
  CONSTRAINT `fk_javascript_projects_java_projects1011`
    FOREIGN KEY (`project_code`)
    REFERENCES `projects_history` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO GCP_cloud (project_code, number_of_regions) VALUES
(104, 3);

-- -----------------------------------------------------
-- Table general_clouds
-- -----------------------------------------------------
DROP TABLE IF EXISTS `general_clouds`;
CREATE TABLE `general_clouds` (
  `GCP_cloud_project_code` INT NOT NULL,
  `AWS_cloud_project_code` INT NOT NULL,
  `Azure_cloud_project_code` INT NOT NULL,
  PRIMARY KEY (`GCP_cloud_project_code`, `AWS_cloud_project_code`, `Azure_cloud_project_code`),
  INDEX `fk_GCP_cloud_has_AWS_cloud_AWS_cloud1_idx` (`AWS_cloud_project_code` ASC),
  INDEX `fk_GCP_cloud_has_AWS_cloud_GCP_cloud1_idx` (`GCP_cloud_project_code` ASC),
  INDEX `fk_GCP_cloud_has_AWS_cloud_Azure_cloud1_idx` (`Azure_cloud_project_code` ASC),
  CONSTRAINT `fk_GCP_cloud_has_AWS_cloud_GCP_cloud1`
    FOREIGN KEY (`GCP_cloud_project_code`)
    REFERENCES `GCP_cloud` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_GCP_cloud_has_AWS_cloud_AWS_cloud1`
    FOREIGN KEY (`AWS_cloud_project_code`)
    REFERENCES `AWS_cloud` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_GCP_cloud_has_AWS_cloud_Azure_cloud1`
    FOREIGN KEY (`Azure_cloud_project_code`)
    REFERENCES `Azure_cloud` (`project_code`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
);

INSERT INTO general_clouds (GCP_cloud_project_code, AWS_cloud_project_code, Azure_cloud_project_code) VALUES
(104, 101, 102),
(104, 103, 105);

SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;
